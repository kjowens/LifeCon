lhi[2]$Table$Values[1]$Axis[1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Y$text
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Y
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Axis$Y
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis[1]$Y
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Axis$Y
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Axis[1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Axis[25]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$.attrs
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Axis[25]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1] # age zero, 25 select years
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Axis[1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$.attrs
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
length(lhi[2]$Table$Values)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
length(lhi[2]$Table$Values[1]$Axis$Axis)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[3]$Table$Values
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[3]$Table$Values[1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[3]$Table$Values$Axis[1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
SOAtbl2Matrix.agg <- function(tblnumb) {#
	require(XML)#
	out <- NULL#
	url <- paste("http://mort.soa.org/data/t",tblnumb,".xml",sep="")#
	tempxml <- xmlParse(url)#
	lhi <- xmlToList(tempxml)#
	lhi2 <- lhi[2]$Table$Values$Axis#
	dum2 <- function(.obj, i) {#
		out2 <- list()#
		temp1 <- .obj[i]$Y#
		out2$x <- as.numeric(temp1$.attrs)#
		out2$q <- as.numeric(temp1$text)#
		return(out2)#
	}#
	indecies <- 1:length(lhi2)#
	myMorArgs <- list(.obj=lhi2)#
	out <- t(mapply(dum2, i=indecies, MoreArgs=myMorArgs))#
	return(out)#
}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
SOAtbl2Matrix.agg(2013)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values$Axis
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$Axis[1] # the first select period, q, then period number
help("...")
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		print("x is",x,", and y is",y)#
	}#
}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		paste("x is",x,", and y is",y)#
	}#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		return(paste("x is",x,", and y is",y))#
	}#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		return(print("x is",x,", and y is",y))#
	}#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		return(cat("x is",x,", and y is",y))#
	}#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	temp <- fun2 <- function(...) {#
		return(cat("x is",x,", and y is",y))#
	}#
	return(temp)#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	temp <- fun2 <- function(...) {#
		cat("x is",x,", and y is",y)#
	}#
	return(temp)#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		cat("x is",x,", and y is",y)#
	}#
	temp <- fun2()#
	return(temp)#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		cat("x is",x,", and y is",y,"\n",sep="")#
	}#
	temp <- fun2()#
	return(temp)#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
fun1 <- function(x, y) {#
	fun2 <- function(...) {#
		cat("x is",x,", and y is ",y,"\n",sep="")#
	}#
	return(fun2())#
}#
fun1(2,3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[2]$Table$Values[1]$Axis$.attrs # the starting select age, [x]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
url <- paste("http://mort.soa.org/data/t",tblnumb,".xml",sep="")#
	tempxml <- xmlParse(url)#
	lhi <- xmlToList(tempxml)#
	lhi2 <- lhi[2]$Table$Values # select table#
	lhi3 <- lhi[3]$Table$Values # ultimate table#
	ages.indecies <- 1:length(lhi[2]$Table$Values)#
	select.periods <- length(lhi[2]$Table$Values[1]$Axis$Axis)#
	select.indecies <- 1:select.periods
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
tblnumb <- 2013
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
url <- paste("http://mort.soa.org/data/t",tblnumb,".xml",sep="")#
	tempxml <- xmlParse(url)#
	lhi <- xmlToList(tempxml)#
	lhi2 <- lhi[2]$Table$Values # select table#
	lhi3 <- lhi[3]$Table$Values # ultimate table#
	ages.indecies <- 1:length(lhi[2]$Table$Values)#
	select.periods <- length(lhi[2]$Table$Values[1]$Axis$Axis)#
	select.indecies <- 1:select.periods
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
.obj.s=lhi2
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
age.i <- 1
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1 <- numeric(select.periods+3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1 <- numeric(select.periods+3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[1] <- as.numeric(.obj.s[age.i]$Axis$.attrs) # the initial age, [x]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dum0 <- function(...) {#
		out0 <- numeric(1)#
		temp0 <- .obj.s[age.i]$Axis$Axis[dur.i]#
		out0 <- as.numeric(temp0$text)#
		return(out0)#
	}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
mapply(dum0, #
			dur.i=select.indecies, #
			MoreArgs=list(age.i, .obj.s=lhi2)#
			)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dum0 <- function(dur.i, ...) {#
		out0 <- numeric(1)#
		temp0 <- .obj.s[age.i]$Axis$Axis[dur.i]#
		out0 <- as.numeric(temp0$text)#
		return(out0)#
	}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
mapply(dum0, #
			dur.i=select.indecies, #
			MoreArgs=list(age.i, .obj.s=lhi2)#
			)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dum0 <- function(dur.i, age.i, .obj.s) {#
		out0 <- numeric(1)#
		temp0 <- .obj.s[age.i]$Axis$Axis[dur.i]#
		out0 <- as.numeric(temp0$text)#
		return(out0)#
	}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
mapply(dum0, #
			dur.i=select.indecies, #
			MoreArgs=list(age.i=age.i, .obj.s=lhi2)#
			)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dum0(1,1,lhi2)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
.obj.s[age.i]$Axis$Axis[dur.i]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dur.i=1
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
.obj.s[age.i]$Axis$Axis[dur.i]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
temp0 <- .obj.s[age.i]$Axis$Axis[dur.i]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out0 <- as.numeric(temp0$text)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out0
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
temp0$text
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
temp0$Y$text
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out0 <- as.numeric(temp0$Y$text)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out0
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
# extracts q frome age/duration intersection#
	dum0 <- function(dur.i, age.i, .obj.s) {#
		out0 <- numeric(1)#
		temp0 <- .obj.s[age.i]$Axis$Axis[dur.i]#
		out0 <- as.numeric(temp0$Y$text)#
		return(out0)#
	}#
	dum0(dur.i=1,1,lhi2)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
mapply(dum0, #
			dur.i=select.indecies, #
			MoreArgs=list(age.i=age.i, .obj.s=lhi2)#
			)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[2:(select.periods+1)] <- mapply(dum0, #
			dur.i=select.indecies, #
			MoreArgs=list(age.i=age.i, .obj.s=lhi2)#
			)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[select.periods+2:]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[select.periods+2:length(out1)]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
select.periods+2
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
length(out1)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[select.periods+2:length(out1)]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[2]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[2:4]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[(select.periods+2):length(out1)]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[-2:-1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[-1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[-(1:(select.periods+1))]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
lhi[3]$Table$Values$Axis[1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
length(lhi[3]$Table$Values$Axis)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out2 <- numeric(2)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
temp2 <- .obj.u$Axis[age.i]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
obj.u <- lhi3
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
temp2 <- .obj.u$Axis[age.i]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
.obj.u <- lhi3
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
temp2 <- .obj.u$Axis[age.i]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out2[1] <- as.numeric(temp2$Y$text)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out2[2] <- as.numeric(temp2$Y$.attrs)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out2
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dum2 <- function(.obj.u, age.i) {#
		# extract the q and ultimate age for given age index#
		out2 <- numeric(2)#
		temp2 <- .obj.u$Axis[age.i]#
		out2[1] <- as.numeric(temp2$Y$text)#
		out2[2] <- as.numeric(temp2$Y$.attrs)#
		return(out2)#
	}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dum2(lhi3, 4)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1[-(1:(select.periods+1))] <- dum2(.obj.u, age.i)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out1
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
help("rbind")
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
myMorArgs <- list(.obj.s=lhi2, .obj.u=lhi3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
mapply(dum1, age.i=1:3, MoreArgs=myMorArgs)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
dum1 <- function(.obj.s, .obj.u, age.i) {#
		# compiles row of select/ultimate table#
		out1 <- numeric(select.periods+3)#
		# 1 for initial age, 1 for ultimate q, 1 for ultimate age#
		out1[1] <- as.numeric(.obj.s[age.i]$Axis$.attrs) # the initial age, [x]#
		out1[2:(select.periods+1)] <- mapply(dum0, #
			dur.i=select.indecies, #
			MoreArgs=list(age.i=age.i, .obj.s=lhi2)#
			)#
		out1[(select.periods+2):length(out1)]#
		out1[-(1:(select.periods+1))] <- dum2(.obj.u, age.i)#
		return(out1)#
	}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
mapply(dum1, age.i=1:3, MoreArgs=myMorArgs)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
foo <- t(mapply(dum1, age.i=age.indecies, MoreArgs=myMorArgs))
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
age.indecies <- 1:length(lhi[2]$Table$Values)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
foo <- t(mapply(dum1, age.i=age.indecies, MoreArgs=myMorArgs))
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
foo
foo
class(foo)
names(foo)
attributes(foo)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out <- t(mapply(dum1, age.i=age.indecies, MoreArgs=myMorArgs))
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
paste(1:3)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
paste((1:3)-1)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
out[1:5,1]
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
paste(out[1:5,1])
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
paste(out[,1])
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
init.select.ages <- cat("[",paste(out[,1]),"]",sep="")
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
init.select.ages <- paste("[",out[,1],"]")
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
init.select.ages
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
init.select.ages <- paste("[",out[,1],"]",sep="")
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
init.select.ages
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
cat()
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
paste("[x]+",select.indecies)
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
paste("[x]+",select.indecies,sep="")
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
paste("q(x+",select.periods,")",sep="")
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
col.names <- list("[x]", paste("q([x]+",select.indecies-1,")",sep=""), paste("q(x+",select.periods,")",sep=""), paste("x+",select.periods,sep=""))
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
col.names
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
col.names <- c("[x]", paste("q([x]+",select.indecies-1,")",sep=""), paste("q(x+",select.periods,")",sep=""), paste("x+",select.periods,sep=""))
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
col.names
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
SOAtbl2Matrix.select <- function(tblnumb) {#
	require(XML)#
	out <- NULL#
	url <- paste("http://mort.soa.org/data/t",tblnumb,".xml",sep="")#
	tempxml <- xmlParse(url)#
	lhi <- xmlToList(tempxml)#
	lhi2 <- lhi[2]$Table$Values # select table#
	lhi3 <- lhi[3]$Table$Values # ultimate table#
	age.indecies <- 1:length(lhi[2]$Table$Values)#
	select.periods <- length(lhi[2]$Table$Values[1]$Axis$Axis)#
	select.indecies <- 1:select.periods#
	myMorArgs <- list(.obj.s=lhi2, .obj.u=lhi3)#
	dum0 <- function(dur.i, age.i, .obj.s) {#
		# extracts q frome age/duration intersection#
		out0 <- numeric(1)#
		temp0 <- .obj.s[age.i]$Axis$Axis[dur.i]#
		out0 <- as.numeric(temp0$Y$text)#
		return(out0)#
	}#
#
	dum1 <- function(.obj.s, .obj.u, age.i) {#
		# compiles row of select/ultimate table#
		out1 <- numeric(select.periods+3)#
		# 1 for initial age, 1 for ultimate q, 1 for ultimate age#
		out1[1] <- as.numeric(.obj.s[age.i]$Axis$.attrs) # the initial age, [x]#
		out1[2:(select.periods+1)] <- mapply(dum0, #
			dur.i=select.indecies, #
			MoreArgs=list(age.i=age.i, .obj.s=lhi2)#
			)#
		out1[(select.periods+2):length(out1)]#
		out1[-(1:(select.periods+1))] <- dum2(.obj.u, age.i)#
		return(out1)#
	}#
#
	dum2 <- function(.obj.u, age.i) {#
		# extract the q and ultimate age for given age index#
		out2 <- numeric(2)#
		temp2 <- .obj.u$Axis[age.i]#
		out2[1] <- as.numeric(temp2$Y$text)#
		out2[2] <- as.numeric(temp2$Y$.attrs)#
		return(out2)#
	}#
	out <- t(mapply(dum1, age.i=age.indecies, MoreArgs=myMorArgs))#
	col.names <- c("[x]", #
		paste("q([x]+",select.indecies-1,")",sep=""),#
		paste("q(x+",select.periods,")",sep=""), #
		paste("x+",select.periods,sep="")#
		)#
	init.select.ages <- paste("[",out[,1],"]",sep="")#
	dimnames(out) <- list(init.select.ages, col.names)#
	return(out)#
}
setwd('/Volumes/hd500/LifeCon/non_standard/examples')
SOAtbl2Matrix.select(2013)
