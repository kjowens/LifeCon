a[y,,]
a["y",,]
a
a["y",,]
a["a",,]
a[]
a[]$x
dimnames(a)
dimnames(a)$x
z <- list(matrix(1:10, nrow=2), matrix(11:20, nrow=2))#
lapply(z, "[", 1, )#
lapply(z, "[", , 3)
z[1]
z[2]
z <- list(a=matrix(1:10, nrow=2), b=matrix(11:20, nrow=2))
lapply(z, "[", 1, )
z <- list(a=data.frame(1:10, nrow=2), b=data.frame(11:20, nrow=2))
z
z <- list(a=matrix(1:10, nrow=2), b=matrix(11:20, nrow=2))
lapply(z, "$", 1, )
lapply(z, "$", "a", )
lapply(z, "$", "a")
z$a
as.data.frame(z$a)
z$a <- as.data.frame(z$a)
z$b <- as.data.frame(z$b)
z
lapply(z, "$", V1)
lapply(z, "$", "V1")
lapply(z, "$")
z
lapply(z, "$",1)
lapply(z, "$","1")
lapply(z, "[",V2)
lapply(z, "[","V2")
lapply(z, "[",1,)
lapply(z, "[",where(right("V1",1)==4))
lapply(z, "[",which(right("V1",1)==4))
??right
mod(4,2)
modulus(4,2)
??mod
is.even(2)
lapply(z, "[",which(right("V1",1)>3))
lapply(z, "[",which("V1">3))
z
lapply(z, "[","V1">2)
z$a[which(z$a>1)]
z$a[which(z$a["V1"]>1)]
502*40*(9.24-7.25)
52*40*(9.24-7.25)
52*40*(9.24-7.25)*.9
library(lifecontingencies)
x <- 1:10#
q <- rep(.2, length(x))#
df <- as.dataframe(cbind(x,q))#
df
df <- data.frame(cbind(x,q))#
df
as.lifetable(df)
x <- 1:10#
lx <- seq(100,0,20)#
tbl <- new("lifetable",x=x, lx=lx)#
tbl
lx <- seq(100,0,-20)#
tbl <- new("lifetable",x=x, lx=lx)#
tbl
x#
lx
x <- 1:10#
lx <- seq(100,0,-10)#
x#
lx#
tbl <- new("lifetable",x=x, lx=lx)#
tbl
x <- 1:10#
lx <- seq(100,10,-10)#
x#
lx#
tbl <- new("lifetable",x=x, lx=lx)#
tbl
(x)
length(x)
length(lx)
tbl
tbl <- new("lifetable",x lx)
tbl <- new("lifetable",x, lx)
library(lifecontingencies)
x <- 1:10#
lx <- seq(100,10,-10)#
length(x)#
length(lx)#
tbl <- new("lifetable",x, lx)#
tbl
x <- 1:3#
lx <- c(100,50,0)#
length(x)#
length(lx)#
tbl <- new("lifetable",x, lx)#
tbl
soa08
tbllist <- list(tbl, tbl, tbl)
pxt(tbl, x=age)
age <- 90#
pxt(tbl, x=age)
pxt(tbl, x=age, t=1)
library(lifecontingencies)
pxt(tbl, x=age, t=1)
qxt(tbl, x=age, t=1)
tbl
tbl <- soa08#
tbllist <- list(tbl, tbl, tbl)#
age <- 90#
qxt(tbl, x=age, t=1)
pxt(tbl, x=age, t=1)
tbllist <- list(tbl, tbl)#
age <- 100#
pxt(tbl, x=age, t=1)
agelist <- list(age, age)
pxyzt(tbllist, agelist, t=1, status="last survivor")
ages <- c(age, age)#
pxyzt(tbllist, ages, t=1, status="last survivor")
pxyt(tbl, tbl, age, age, t=1, status="last survivor")
qxt(tbl, x=age, t=1)
y <- pxt(tbl, x=age, t=1)
y
2*y - y^2
pxyzt(tbllist3, ages3, t=1, status="last survivor")
ages3 <- c(age, age, age)#
tbllist3 <- list(tbl, tbl, tbl)#
pxyzt(tbllist3, ages3, t=1, status="last survivor")
3*y - 3*y^2 + y^3
help(apply)
mapply(rep, 1:4, 4:1)
X <- list(list(a = pi, b = list(c = 1:1)), d = "a test")#
rapply(X, function(x) x, how = "replace")
x <- list(1:4)
x
rapply(x, sqrt)
x
rapply(x, sqrt, how="replace")#
x
x <- list(1:4, list(5:8))#
x#
rapply(x, sqrt, how="replace")#
x
x <- list(list(1:4), list(5:8))#
x#
rapply(x, sqrt, how="replace")#
x
lapply(x, sqrt)
rapply(x, sqrt, how="list")
mapply(rep, 1:4, 4:1)
help(rep)
mapply(rep, x=1:4, times=4:1)
mapply(rep, times=1:4, x=4:1)
help("attributes")
a <- 1:5
a
class(a)
attributes(a) <- list(hi="hi")
a
attributes(a)
attributes(a)$hi
setwd('/Volumes/amy/LifeCon/non_standard/examples')
library(devtools)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
load_all('/Volumes/amy/LifeCon/LifeCon')
setwd('/Volumes/amy/LifeCon/non_standard/examples')
tbl <- SOAtbl2df.agg(15006)#
tbl
setwd('/Volumes/amy/LifeCon/non_standard/examples')
head(tbl)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
x = 30
setwd('/Volumes/amy/LifeCon/non_standard/examples')
tbl[which(tbl$x > x - 0.5),]
setwd('/Volumes/amy/LifeCon/non_standard/examples')
tbl[which(tbl$x > x - 0.5),]$qx
setwd('/Volumes/amy/LifeCon/non_standard/examples')
unlist(tbl[which(tbl$x > x - 0.5),]$qx)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
get_qs <- function(age, table) {#
	age <- floor(age)#
	qs <- unlist(table[which(table$x > x - 0.5),]$qx)#
	return(qs)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
get_qs(90)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
get_qs(90,tbl)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
get_qs <- function(age, table) {#
	# Returns vector of mortality rates#
	# assumes age is called "x" and mortality rates "qx"#
	age <- floor(age)#
	qs <- unlist(table[which(table$x > age - 0.5),]$qx)#
	return(qs)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
get_qs(90,tbl)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
rm(x)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
ia_0 <- function(q, v) {#
	BLFOR(.ones(q), (1-q)*v, 0)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q = get_qs(90, tbl)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q
setwd('/Volumes/amy/LifeCon/non_standard/examples')
v = 1.05^-1
setwd('/Volumes/amy/LifeCon/non_standard/examples')
v
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q = get_qs(97, tbl)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
ia_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
ia_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
wl_0 <- function(age, table) {#
	BLFOR(v*q, (1-q)*v, 0)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
wl_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
wl_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
wl_0 <- function(age, table) {#
	BLFOR(v*q, (1-q)*v, 1)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
wl_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
wl_0 <- function(age, table) {#
	BLFOR(v*q, (1-q)*v, 1)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
wl_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
tail(tbl)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
wl_0 <- function(q, v) {#
	BLFOR(v*q, (1-q)*v, 1)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
wl_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
v[1:5]
setwd('/Volumes/amy/LifeCon/non_standard/examples')
min(4,5)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
term_0 <- function(q, v, term) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	out <- BLFOR(v*q, (1-q)*v, 0)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
term_0(q, v, 3)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
term_0 <- function(q, v, term) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	out <- BLFOR(v*q, (1-q)*v, 0)#
	return(out)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
term_0(q, v, 3)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
term_0(q, v, 10)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
endow_0 <- function(q, v, term, db=1, sb=1) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	db_term <- min(length(db),term)#
	db <- v[1:db_term]#
	out <- BLFOR(v*q*db, (1-q)*v, sb)#
	return(out)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
endow_0(q, v, 3)#
endow_0(q, v, 10)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
term_0(q, v, 2)#
term_0(q, v, 10)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
endow_0(q, v, 2)#
endow_0(q, v, 10)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
wl_0(q,v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
tail(tbl)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q = get_qs(97, tbl)#
v = .95#
#
ia_0 <- function(q, v) {#
	BLFOR(.ones(q), (1-q)*v, 0)#
}#
#
q#
v#
ia_0(q, v)#
#
wl_0 <- function(q, v) {#
	BLFOR(v*q, (1-q)*v, 1)#
}#
#
q#
v#
wl_0(q, v)#
term_0 <- function(q, v, term) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	out <- BLFOR(v*q, (1-q)*v, 0)#
	return(out)#
}#
#
q#
v#
term_0(q, v, 2)#
term_0(q, v, 10)#
#
endow_0 <- function(q, v, term, db=1, sb=1) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	db_term <- min(length(db),term)#
	db <- v[1:db_term]#
	out <- BLFOR(v*q*db, (1-q)*v, sb)#
	return(out)#
}#
#
q#
v#
endow_0(q, v, 2)#
endow_0(q, v, 10)#
wl_0(q,v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q = c(rep(3,3),1)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q = c(rep(.3,3),1)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
ia_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
ia_0 <- function(q, v, pmt=1) {#
	temp <- c(rep(1,length(q)-1),0)#
	BLFOR(temp*pmt, (1-q)*v, 0)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
ia_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
ia_0 <- function(q, v, pmt=1) {#
	BLFOR(.ones(q)*pmt, (1-q)*v, 0)#
}#
#
q#
v#
ia_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
ia_0(c(.3,1),.9)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
.ones(q)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q = c(rep(.3,3),1)#
v = .9
setwd('/Volumes/amy/LifeCon/non_standard/examples')
q#
v#
ia_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
wl_0 <- function(q, v) {#
	BLFOR(v*q, (1-q)*v, 1)#
}#
#
q#
v#
wl_0(q, v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
term_0 <- function(q, v, term) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	out <- BLFOR(v*q, (1-q)*v, 0)#
	return(out)#
}#
#
q#
v#
term_0(q, v, 2)#
term_0(q, v, 10)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
endow_0 <- function(q, v, term, db=1, sb=1) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	db_term <- min(length(db),term)#
	db <- v[1:db_term]#
	out <- BLFOR(v*q*db, (1-q)*v, sb)#
	return(out)#
}#
#
q#
v#
endow_0(q, v, 2)#
endow_0(q, v, 10)#
wl_0(q,v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
debug(endow_0)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
endow_0(q, v, 10)
q
setwd('/Volumes/amy/LifeCon/non_standard/examples')
endow_0 <- function(q, v, term, db=1, sb=1) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	db_term <- min(length(db),term)#
	db <- db[1:db_term]#
	out <- BLFOR(v*q*db, (1-q)*v, sb)#
	return(out)#
}
setwd('/Volumes/amy/LifeCon/non_standard/examples')
undebug(endow_0)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
endow_0(q, v, 10)#
wl_0(q,v)
setwd('/Volumes/amy/LifeCon/non_standard/examples')
# 2014-08-03#
# setting up some basic insurance and annuity functions#
#
get_qs <- function(age, table) {#
	# Returns vector of mortality rates#
	# assumes age is called "x" and mortality rates "qx"#
	age <- floor(age)#
	qs <- unlist(table[which(table$x > age - 0.5),]$qx)#
	return(qs)#
}#
#
ia_0 <- function(q, v, pmt=1) {#
	BLFOR(.ones(q)*pmt, (1-q)*v, 0)#
}#
#
wl_0 <- function(q, v) {#
	BLFOR(q*v, (1-q)*v, 1)#
}#
#
term_0 <- function(q, v, term) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	out <- BLFOR(v*q, (1-q)*v, 0)#
	return(out)#
}#
#
endow_0 <- function(q, v, term, db=1, sb=1) {#
	q_term <- min(length(q),term)#
	q <- q[1:q_term]#
	v_term <- min(length(v),term)#
	v <- v[1:v_term]#
	db_term <- min(length(db),term)#
	db <- db[1:db_term]#
	out <- BLFOR(v*q*db, (1-q)*v, sb)#
	return(out)#
}#
# immediate_annuity <- function(age, table, discount_factors) {#
##
# }#
#
###############################
# testing#
###############################
#
# https://stackoverflow.com/questions/5339796/loading-an-r-package-from-a-custom-directory#
library(devtools)#
#
# load package w/o installing#
load_all('/Volumes/amy/LifeCon/LifeCon')#
#
# or invoke 'R CMD INSTALL'#
# install('/some/package/diR')#
#
# rcpp_hello_world()#
#
tbl <- SOAtbl2df.agg(15006)#
#
tbl#
head(tbl)#
x = 30#
unlist(tbl[which(tbl$x > x - 0.5),]$qx)#
#
get_qs(90,tbl)#
#
tail(tbl)#
get_qs(97, tbl)#
q = c(rep(.3,3),1)#
v = .9#
q#
v#
ia_0(q, v)#
#
q#
v#
wl_0(q, v)#
#
q#
v#
term_0(q, v, 2)#
term_0(q, v, 10)#
#
q#
v#
endow_0(q, v, 2)#
endow_0(q, v, 10)#
wl_0(q,v)
